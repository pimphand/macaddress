cat <<EOF > /etc/centreon-gorgone/config.d/40-gorgoned.yaml
name:  gorgoned-poller-192-168-50-13
description: Configuration for poller poller-192-168-50-13
gorgone:
  gorgonecore:
    id: 342
    external_com_type: tcp
    external_com_path: "*:5556"
    authorized_clients: 
    privkey: "/var/lib/centreon-gorgone/.keys/rsakey.priv.pem"
    pubkey: "/var/lib/centreon-gorgone/.keys/rsakey.pub.pem"
  modules:
    - name: action
      package: gorgone::modules::core::action::hooks
      enable: true
      whitelist_cmds: true
      allowed_cmds:
        - ^sudo\s+(/bin/)?systemctl\s+(reload|restart)\s+(centengine|centreontrapd|cbd)\s*$
        - ^(sudo\s+)?(/usr/bin/)?service\s+(centengine|centreontrapd|cbd|cbd-sql)\s+(reload|restart)\s*$
        - ^/usr/sbin/centenginestats\s+-c\s+/etc/centreon-engine/centengine\.cfg\s*$
        - ^cat\s+/var/lib/centreon-engine/[a-zA-Z0-9\-]+-stats\.json\s*$
        - ^/usr/lib/centreon/plugins/.*$
        - ^/bin/perl /usr/share/centreon/bin/anomaly_detection --seasonality >> /var/log/centreon/anomaly_detection\.log 2>&1\s*$
        - ^/usr/bin/php -q /usr/share/centreon/cron/centreon-helios\.php >> /var/log/centreon-helios\.log 2>&1\s*$
        - ^centreon
        - ^mkdir
        - ^/usr/share/centreon/www/modules/centreon-autodiscovery-server/script/run_save_discovered_host
        - ^/usr/share/centreon/bin/centreon -u \"centreon-gorgone\" -p \S+ -w -o CentreonWorker -a processQueue$

    - name: engine
      package: gorgone::modules::centreon::engine::hooks
      enable: true
      command_file: "/var/lib/centreon-engine/rw/centengine.cmd"

EOF
ls -l /etc/centreon-gorgone/config.d/40-gorgoned.yaml
ls -ld /etc/centreon-gorgone/config.d
chown centreon-gorgone:centreon-gorgone /etc/centreon-gorgone/config.d/40-gorgoned.yaml
chmod 640 /etc/centreon-gorgone/config.d/40-gorgoned.yaml
https://nms-dev.awetonet.io/centreon/main.php?p=60903&o=c&nagios_id=343

-rw-r--r-- 1 centreon-gorgone centreon-gorgone 1547 Oct  5 23:49 /etc/centreon-gorgone/config.d/40-gorgoned.yaml
drwxrwxr-x 4 centreon-gorgone centreon-gorgone 4096 Oct  5 23:44 /etc/centreon-gorgone/config.d

https://docs.centreon.com/docs/monitoring/monitoring-servers/add-a-poller-to-configuration/
